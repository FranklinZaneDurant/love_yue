# 生产环境配置

# 数据库配置
spring.datasource.url=jdbc:postgresql://prod-db-server:5432/loveyue_auth_prod?useUnicode=true&characterEncoding=utf8&serverTimezone=Asia/Shanghai&ssl=true&sslmode=require
spring.datasource.username=${DB_USERNAME:loveyue_prod}
spring.datasource.password=${DB_PASSWORD:loveyue_prod123}
spring.datasource.hikari.minimum-idle=10
spring.datasource.hikari.maximum-pool-size=50
spring.datasource.hikari.connection-timeout=60000
spring.datasource.hikari.validation-timeout=3000
spring.datasource.hikari.leak-detection-threshold=60000

# JPA配置
spring.jpa.hibernate.ddl-auto=validate
spring.jpa.show-sql=false
spring.jpa.properties.hibernate.format_sql=false
spring.jpa.properties.hibernate.use_sql_comments=false
spring.jpa.properties.hibernate.jdbc.batch_size=50
spring.jpa.properties.hibernate.cache.use_second_level_cache=true
spring.jpa.properties.hibernate.cache.use_query_cache=true
spring.jpa.properties.hibernate.cache.region.factory_class=org.hibernate.cache.jcache.JCacheRegionFactory

# Redis配置
spring.redis.host=${REDIS_HOST:prod-redis-server}
spring.redis.port=${REDIS_PORT:6379}
spring.redis.password=${REDIS_PASSWORD:}
spring.redis.database=1
spring.redis.timeout=5000ms
spring.redis.lettuce.pool.max-active=20
spring.redis.lettuce.pool.max-wait=5000ms
spring.redis.lettuce.pool.max-idle=10
spring.redis.lettuce.pool.min-idle=5
spring.redis.lettuce.shutdown-timeout=100ms

# 服务发现配置
spring.cloud.nacos.discovery.server-addr=${NACOS_SERVER:prod-nacos-server:8848}
spring.cloud.nacos.discovery.namespace=loveyue-prod
spring.cloud.nacos.discovery.group=PROD_GROUP
spring.cloud.nacos.discovery.metadata.version=1.0.0
spring.cloud.nacos.discovery.metadata.zone=prod
spring.cloud.nacos.config.server-addr=${NACOS_SERVER:prod-nacos-server:8848}
spring.cloud.nacos.config.namespace=loveyue-prod
spring.cloud.nacos.config.group=PROD_GROUP

# 认证配置（生产环境严格配置）
auth.jwt.secret=${JWT_SECRET:loveyue-auth-jwt-secret-key-2025-production-environment-very-secure}
auth.jwt.access-token-expire-minutes=60
auth.jwt.refresh-token-expire-days=3
auth.jwt.temp-token-expire-minutes=15

auth.login.max-attempts=3
auth.login.lock-duration-minutes=60
auth.login.captcha-enabled=true
auth.login.captcha-threshold=2
auth.login.single-sign-on-check=true

auth.token.max-active-tokens-per-userEntity=3
auth.token.cleanup-interval-hours=6
auth.token.unused-token-threshold-days=7

auth.password.expire-days=60
auth.password.expire-warning-days=7
auth.password.complexity-check-enabled=true
auth.password.min-length=12
auth.password.max-length=64
auth.password.require-digit=true
auth.password.require-lowercase=true
auth.password.require-uppercase=true
auth.password.require-special-char=true
auth.password.reset-token-expire-minutes=15

auth.security.ip-whitelist-enabled=true
auth.security.ip-whitelist=${IP_WHITELIST:}
auth.security.device-fingerprint-enabled=true
auth.security.suspicious-login-detection=true
auth.security.remote-location-detection=true
auth.security.unusual-time-detection=true
auth.security.two-factor-auth-enabled=true
auth.security.session-timeout-minutes=120
auth.security.csrf-protection-enabled=true

# 日志配置
logging.level.com.loveyue.auth=INFO
logging.level.org.springframework.security=WARN
logging.level.org.hibernate.SQL=WARN
logging.level.org.hibernate.type.descriptor.sql.BasicBinder=WARN
logging.level.root=WARN
logging.pattern.console=%d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %-5level [%X{traceId}] %logger{36} - %msg%n
logging.pattern.file=%d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %-5level [%X{traceId}] %logger{36} - %msg%n
logging.file.name=/var/log/loveyue/auth-service.log
logging.file.max-size=500MB
logging.file.max-history=90
logging.file.total-size-cap=10GB

# 管理端点配置
management.endpoints.web.exposure.include=health,info,metrics,prometheus
management.endpoint.health.show-details=when-authorized
management.endpoint.health.roles=ADMIN
management.endpoints.web.base-path=/actuator
management.server.port=8082
management.security.enabled=true

# Swagger配置（生产环境禁用）
springdoc.api-docs.enabled=false
springdoc.swagger-ui.enabled=false

# 异步配置
async.core-pool-size=10
async.max-pool-size=50
async.queue-capacity=500
async.thread-name-prefix=auth-async-prod-
async.keep-alive-seconds=300

# 定时任务配置
scheduling.pool.size=10
scheduling.thread-name-prefix=auth-scheduling-prod-

# 性能配置
server.tomcat.max-threads=200
server.tomcat.min-spare-threads=20
server.tomcat.max-connections=8192
server.tomcat.accept-count=100
server.tomcat.connection-timeout=20000
server.compression.enabled=true
server.compression.mime-types=application/json,application/xml,text/html,text/xml,text/plain,application/javascript,text/css